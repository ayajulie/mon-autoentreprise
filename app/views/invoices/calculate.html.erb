

<%= render 'shared/navbar' %>
<%= render '/pages/sidebar' %>

<div class="dashboard-content" style="margin-left: 250px; margin-right: 30px">


    <div class="row pt-4 d-flex justify-content-around my-0 py-0">
      <div class="dashboard-upper-part col-xs-12 col-sm-7">
        <div class="dashboard-upper-part-card" style="width: 15%">
          <div><i class="fas fa-chart-line"></i> CA</div>
          <div id="turnover">
            <span id="monthly-turnover"><%= @current_month_turnover %> </span>
            <span id="yearly-turnover" class="d-none"><%= @past_12_months_turnover %> </span>
            <span id="exercise-turnover" class="d-none"><%= @current_year_turnover %> </span>
            <i class="fas fa-euro-sign"></i>
          </div>
          <div class="d-flex justify-content-center">
            <div>
              <button class="btn btn-ghost active" id="btn-monthly-turnover" >Mois</button>
            </div>
            <div>
              <button class="btn btn-ghost" id="btn-yearly-turnover" >12 Mois</button>
            </div>
            <div>
              <button class="btn btn-ghost" id="btn-exercise-turnover" >Exercice</button>
            </div>
          </div>
        </div>
         <div class="dashboard-upper-part-card" style="width: 15%">
          <div><i class="fas fa-users"></i> Nouveaux clients</div>
            <span id="past-month-new-clients">+ 9</span>
            <span id="past-year-new-clients" class="d-none">+ 126</span>
            <span id="this-exercise-new-clients" class="d-none">+ 53</span>
          <div class="d-flex justify-content-center">
            <div>
              <button class="btn btn-ghost active" id="btn-month-new-clients" >Mois</button>
            </div>
            <div>
              <button class="btn btn-ghost" id="btn-year-new-clients"  >12 Mois</button>
            </div>
            <div>
              <button class="btn btn-ghost" id="btn-exercise-new-clients" >Exercice</button>
            </div>
          </div>
        </div>
      </div>
      <div class="dashboard-upper-part-card col-xs-12 col-sm-4" style="width: 30%">
        <div>Les échéances du mois</div>
        <div></div>
      </div>
    </div>

    <div class="row pt-4 d-flex justify-content-around my-0 py-0">
        <div class="col-xs-12 col-sm-7 dashboard-chart-card">
          Chiffre d'affaire sur 12 mois glissants
          <canvas id="myChart2" data-monthly-turnover-previous-year= "[3500, 10500, 2300, 5500, 3400, 7900, 1200, 1900, 3000, 5000, 1250, 6700]".to_json
           height="200" aria-label="Hello ARIA World" >
            <p>Hello Fallback World</p>
          </canvas>
        </div>
        <div class="col-xs-12 col-sm-4 dashboard-chart-card">
          <div class='mb-2'>Chiffre d'affaire sur l'exercice fiscal</div>
          <div class='mt-6 py-2'>
            <canvas id="doughnut-chart" height="200" aria-label="Hello ARIA World" class="pt-6">
              <p>Hello Fallback World</p>
            </canvas>
          </div>
          <div>
            CA max 72000 <i class="fas fa-euro-sign"></i>
          </div>
        </div>
    </div>

    <div class="row pt-4 d-flex justify-content-around my-0 py-0">
      <div class="col-xs-12 col-sm-5 dashboard-chart-card">
        <div class='mb-2'>Factures en attente de paiement</div>
        <div class='mt-6 py-2'>
          <div class="dashboard-upper-part-card px-0" style="width: 95%">
            <table class="table">
            <tbody>
              <tr><td style="border-top: 0px">Total</td><td style="border-top: 0px">2700€</td><td style="border-top: 0px"><%= link_to root_path do %><i class="fas fa-info-circle"></i><% end %></td></tr>
              <tr><td>Aujourd'hui</td><td>400€</td><td><%= link_to root_path do %><i class="fas fa-info-circle"></i><% end %></td></tr>
              <tr><td>Cette semaine</td><td>1200€</td><td><%= link_to root_path do %><i class="fas fa-info-circle"></i><% end %></td></tr>
              <tr><td>Ce mois</td><td>2400€</td><td><%= link_to root_path do %><i class="fas fa-info-circle"></i><% end %></td></tr>
            </tbody>
            <!--
            <thead>
              <tr>
                <th>Client</th>
                <th>Echéance</th>
                <th>Montant</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Mr Durand</td><td style='font-size : 0.8em; font-weight: 400;'>15/04/2021</td><td>300€</td></tr>
              <tr><td>Mr Dupond</td><td style='font-size : 0.8em; font-weight: 400;'>10/04/2021</td><td>600€</td></tr>
              <tr><td>Mme Martin</td><td style='font-size : 0.8em; font-weight: 400;'>09/04/2021</td><td>400€</td></tr>
              <tr><td>Mr Durand</td><td style='font-size : 0.8em; font-weight: 400;'>11/04/2021</td><td>700€</td></tr>
            </tbody>
            -->
          </table>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-3 dashboard-chart-card">
        <div class='mb-2'>À déclarer</div>
        <div class='mt-6 py-2'>
          <div class="dashboard-upper-part-card px-0" style="width: 85%">
            <div>Impôt sur le revenu</div>
            <div>
              <% if current_user.main_activity_choose == "commerce de détail" %>
                <%= @past_year_income_tax_revente %>
              <% else %>
                <%= @past_year_income_tax_service %>
              <% end %>
              <i class="fas fa-euro-sign"></i>
            </div>
            <div class= "date-italics">30/05/2021</div>
          </div>
          <div class="dashboard-upper-part-card px-0" style="width: 85%">
            <div>TVA</div>
            <div>
              <%= @past_year_tva  %>
              <i class="fas fa-euro-sign"></i>
            </div>
            <div class= "date-italics">02/05/2021</div>
          </div>
          <div class="dashboard-upper-part-card px-0" style="width: 85%">
            <div>Chiffres d'affaire du mois</div>
            <div> <%= @current_month_turnover  %><i class="fas fa-euro-sign"></i></div>

            <div class= "date-italics">30/03/2021</div>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-3 dashboard-chart-card">
        <div class='mb-2'>À payer</div>
        <div class='mt-6 py-2'>
          <div class="dashboard-upper-part-card px-0" style="width: 85%">
            <div>Côtisations sociales</div>
            <div>
              <% if current_user.main_activity_choose == "commerce de détail" %>
                <%= @charge_sociale_vente %>
              <% else %>
                <%= @charge_sociale_service %>
              <% end %>
              <i class="fas fa-euro-sign"></i>
            </div>
            <div class= "date-italics">31/03/2021</div>
          </div>
          <div class="dashboard-upper-part-card px-0" style="width: 85%">
            <div>CFE</div>
            <div>823,05 <i class="fas fa-euro-sign"></i></div>

            <div class= "date-italics">30/04/2021</div>
          </div>
          <div class="dashboard-upper-part-card px-0" style="width: 85%">
            <div>Taxes consulaires</div>
            <div>
              <% if current_user.main_activity_choose == "commerce de détail" %>
                <%= @taxe_chambre_consulaire_service %>
              <% else %>
                <%= @taxe_chambre_consulaire_service %>
              <% end %>
              <i class="fas fa-euro-sign"></i>
            </div>
            <div class= "date-italics">30/09/2021</div>
          </div>
        </div>
      </div>
    </div>
</div>
<hr>

<div class="dashboard-chart-card" height="200" style="margin-left: 250px;">
            Tableau des CA mensuels des 12 derniers mois : <%= @monthly_past_12_months_turnover %>
            <hr>
            Tableau des CA mensuels des 12 mois précédents : <%= @monthly_previous_past_12_months_turnover %>
            <hr>
            CA de l'exercice / année en cours : <%= @current_year_turnover %>
            <hr>
            CA de l'année n-1 : <%= @past_year_turnover %>
            <hr>
            CA de l'année n-2 : <%= @previous_past_year_turnover %>
            <hr>
            Taxes de l'année en cours (si vente) : <%= @current_year_total_taxes_vente  %>
            <hr>
            Taxes de l'année en cours (si service) : <%= @current_year_total_taxes_service  %>
            <hr>
            Données graph doughnut : <%= @current_year_data %>




            <p> Votre chiffre d'affaires est égal à <%= @turn_over %> €</p>
            <b>Cotisations sociales</b><br />
            <% if current_user.main_activity_choose == "commerce de détail" %>
              <p> Vos cotisations Sociales sont égales à <%= @charge_sociale_vente %> €</p>
            <% else %>
              <p> Vos cotisations Sociales sont égales à <%= @charge_sociale_service %> €</p>
            <% end %>
            <p>
              <b>Taxe consulaire</b><br />
            </p>
            <br>
            <% if current_user.main_activity_choose == "commerce de détail" %>
              <p> Vos cotisations Sociales sont égales à <%= @taxe_chambre_consulaire_service %> €</p>
            <% else %>
              <p> Votre taxe consulaire est égale à <%= @taxe_chambre_consulaire_service %> €</p>
            <% end %>
            <p>
              <% if current_user.main_activity_choose == "commerce de détail" %>
                <p> Votre impôt sur le revenu à déclarer est égal <%= @income_tax_revente %> €</p>
              <% else %>
                <p> Votre impôt sur le revenu à déclarer est égal <%= @income_tax_service %> €</p>
              <% end %>

              <p> Si vous avez choisi d'être assujeti à la TVA, vous devez déclarer le chiffre <%= @tva %>€ </p>

              <% if current_user.main_activity_choose == "commerce de détail" %>
                <p> Il vous reste à facturer <%= @restant_a_facture_commerce %> €</p>
              <% else %>
                <p> Votre chiffre d'affaire maximum est de 72 000 €</p>
              <% end %>
            <p> Votre chiffre d'affaire maximum est de 72 000 €</p>
          </div>

